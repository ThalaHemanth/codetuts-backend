{"version":3,"sources":["../../src/resolvers/Mutation.js"],"names":["Mutation","Signup","parent","email","password","firebase","auth","createUserWithEmailAndPassword","catch","console","log","err","Signin","signInWithEmailAndPassword","CreateApi","args","db","title","toLowerCase","Language","playlistId","id","Items","axios","get","data","items","map","channel","item","snippet","channelTitle","thumbnail","thumbnails","default","url","video","resourceId","videoId","urls","promises","Promise","all","res","response","duration","contentDetails","videoDetails","newItems","tempItems","forEach","Math","round","moment","asMinutes","push","collection","add","playlist","language"],"mappings":"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","file":"Mutation.js","sourcesContent":["/* eslint-disable prefer-destructuring */\n/* eslint-disable no-shadow */\nimport uuid from 'uuid/v4';\nimport axios from 'axios';\nimport moment from 'moment';\n\nconst Mutation = {\n  Signup: (parent, { email, password }, { firebase }) => {\n    firebase\n      .auth()\n      .createUserWithEmailAndPassword(email, password)\n      .catch(err => console.log(err));\n    return 'Success';\n  },\n  Signin: (parent, { email, password }, { firebase }) => {\n    firebase\n      .auth()\n      .signInWithEmailAndPassword(email, password)\n      .catch(err => console.log(err));\n    return 'Logged In';\n  },\n  CreateApi: async (parent, args, { db }) => {\n    const title = args.title.toLowerCase();\n    const Language = args.Language.toLowerCase();\n    const { playlistId } = args;\n    const id = uuid();\n    let Items = [];\n    const { data } = await axios.get(\n      `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${playlistId}&key=AIzaSyCxqkIJes14pl7_8hSkgq_cApTDRgK12OI&maxResults=50`\n    );\n    Items = data.items.map(item => ({\n      channel: item.snippet.channelTitle,\n      thumbnail: item.snippet.thumbnails.default.url,\n      title: item.snippet.title,\n      video: item.snippet.resourceId.videoId,\n    }));\n    const urls = Items.map(\n      item =>\n        `https://www.googleapis.com/youtube/v3/videos?part=contentDetails&id=${\n          item.video\n        }&key=AIzaSyCxqkIJes14pl7_8hSkgq_cApTDRgK12OI`\n    );\n    const promises = urls.map(url => axios.get(url));\n    const res = await Promise.all(promises);\n    const videoDetails = await res.map(response => ({\n      id: response.data.items[0].id,\n      duration: response.data.items[0].contentDetails.duration,\n    }));\n    const newItems = Items.map(item => {\n      const tempItems = [];\n      videoDetails.forEach(video => {\n        if (video.id === item.video) {\n          const duration = Math.round(\n            moment.duration(video.duration).asMinutes()\n          );\n          tempItems.push({\n            ...item,\n            duration,\n          });\n        }\n      });\n      return { ...tempItems };\n    });\n    console.log(newItems[0]);\n\n    db.collection(Language).add({\n      id,\n      title,\n      playlistId,\n      playlist: newItems,\n    });\n\n    return {\n      id,\n      title,\n      language: Language,\n      playlist: newItems,\n    };\n  },\n};\n\nexport { Mutation as default };\n"]}